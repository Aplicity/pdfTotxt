自然语言处理导论

张梅山
黑龙江大学

（https://zhangmeishan.github.io/）

主要内容

自然语言处理任务简介
文本分类
序列标注
结构学习
序列到序列

主要内容

自然语言处理任务简介
文本分类
序列标注
结构学习
序列到序列

基本印象

输入： 本次课将介绍自然语言处理相关的基本任务

输出：

基本印象

输入： 本次课将介绍自然语言处理相关的基本任务

输出：

中文分词

基本印象

输入： 本次课将介绍自然语言处理相关的基本任务

输出：

词性/词类标注

基本印象

输入： 本次课将介绍自然语言处理相关的基本任务

输出：

句法分析

自然语言处理任务介绍

基础分析

 分词
 词性标注
 句法分析
 语义分析
 篇章分析

自然语言处理任务介绍

自然语言处理基本应用

 情感分析
 机器翻译
 实体识别
 阅读理解
 智能对话

自然语言处理任务介绍

自然语言处理基本应用

 情感分析
 机器翻译
 实体识别
 阅读理解
 智能对话

自然语言处理任务介绍

自然语言处理基本应用

 情感分析
 机器翻译
 实体识别
 阅读理解
 智能对话

自然语言处理任务介绍

自然语言处理基本应用

 情感分析
 机器翻译
 实体识别
 阅读理解
 智能对话

自然语言处理任务介绍

自然语言处理基本应用

 情感分析
 机器翻译
 实体识别
 阅读理解
 智能对话

问题：谁在裁判判罚中获利？

答：马拉多纳的老对手英格兰

自然语言处理任务介绍

自然语言处理基本应用

 情感分析
 机器翻译
 实体识别
 阅读理解
 智能对话

自然语言处理任务介绍

基础分析
 分词
 词性标注
 句法分析
 语义分析
 篇章分析

自然语言处理基本应用
 情感分析
 机器翻译
 实体识别
 阅读理解
 智能对话

目的：用计算机自动完成这一切。

自然语言处理基本方法

一切都是分类

机器学习模型

y = Wx

x特征表示向量
W模型参数
y输出向量

自然语言处理基本方法

文本分类

https://github.com/bamtercelboo/cnn-lstm-bilstm-deepcnn-
clstm-in-pytorch

序列标注

https://github.com/jiesutd/NCRFpp

结构学习
序列到序列

https://github.com/whr94621/NJUNMT-pytorch

主要内容

自然语言处理任务简介
文本分类
序列标注
结构学习
序列到序列

文本分类

情感分析
主题分类
文本蕴含
阅读理解
关系分类
股票预测
票房分析
……

情感分析

我 自己 连 看 了 三 遍 夏洛特烦恼
正面|负面|中立

情感分析

输入：

我 自己 连 看 了 三 遍 夏洛特烦恼

情感分析

传统方法

我 自己 连 看 了 三 遍 夏洛特烦恼

情感分析

传统方法

我 自己 连 看 了 三 遍 夏洛特烦恼

1. 特征提取 (T1)

F = {T1=我, T1=自己, T1=连, T1=看, T1=了, T1=三, T1=遍, T1=夏洛特烦恼}

情感分析

传统方法

我 自己 连 看 了 三 遍 夏洛特烦恼

1. 特征提取 (T1, T2)

F = {T1=我, T1=自己, T1=连, T1=看, T1=了, T1=三, T1=遍, T1=夏洛特烦恼, 
T2=我 自己, T2=自己 连, T2=连 看, T2=看 了, T2=了 三, T2=三 遍, T2=遍 夏

洛特烦恼}

情感分析

传统方法

我 自己 连 看 了 三 遍 夏洛特烦恼

1. 特征提取 (T1, T2)

F = {T1=我, T1=自己, T1=连, T1=看, T1=了, T1=三, T1=遍, T1=夏洛特烦恼, 
T2=我 自己, T2=自己 连, T2=连 看, T2=看 了, T2=了 三, T2=三 遍, T2=遍 夏

洛特烦恼}

2. 加载模型(V, W)

V:    特征词典集合 𝒙 = 𝒍𝒐𝒐𝒌𝒖𝒑 𝑭, 𝑽 𝒙 ∈ 𝑹 𝑽 （行向量）

W:   特征极性权重 W∈ 𝑹𝟑× 𝑽

情感分析

传统方法

我 自己 连 看 了 三 遍 夏洛特烦恼

1. 特征提取 (T1, T2)
2. 加载模型(V, W)

V:    特征词典集合 𝒙 = 𝒍𝒐𝒐𝒌𝒖𝒑 𝑭, 𝑽 𝒙 ∈ 𝑹 𝑽

W:   特征极性权重 W∈ 𝑹𝟑× 𝑽

3.  预 测

𝒚 = 𝑾𝒙

情感分析

传统方法

我 自己 连 看 了 三 遍 夏洛特烦恼

1. 特征提取 (T1, T2)
2. 加载模型(V, W)

3.  预 测 𝒚 = 𝑾𝒙
4.  参数更新(训练、模型调整)

∆𝒚 = 𝒅𝒊𝒔𝒕(𝒚, 𝒚𝒈 )
𝑾 = 𝑾 − 𝜼∆𝑾

∆𝑾 = ∆𝒚 𝒙′

情感分析

我 自己 连 看 了 三 遍 夏洛特烦恼

传统方法：

特征提取 (T1, T2)

F = {T1=我, T1=自己, T1=连, T1=看, T1=了, T1=三, T1=遍, 
T1=夏洛特烦恼, T2=我 自己, T2=自己 连, T2=连 看, T2=看
了, T2=了 三, T2=三 遍, T2=遍 夏洛特烦恼}

特征表：∑ （每个特征赋予一个id）

<0, …, 0, 1, …, 0, 0, 1, 1, 0, …>

稀疏向量表示

• 特征总数有多少，维度
便有多少
• 对于每一个样例，只有
很少几个不为零值

T1=我

T2=自己 连

T2=我 自己

深度学习

我 自己 连 看 了 三 遍 夏洛特烦恼

e1

e2

e3

e4 e5 e6 e7

e8

深度学习

我 自己 连 看 了 三 遍 夏洛特烦恼

e1

e2

e3

e4 e5 e6 e7

e8

0.2

-1.3

0.5

-10.2

4.3

深度学习的基础：稠密向量表示
• 维数比较低，一般不超过500维
• 基本上都为非零值，实数

深度学习

我 自己 连 看 了 三 遍 夏洛特烦恼

e1

e2

e3

e4 e5 e6 e7

e8

0.2

-1.3

0.5

-10.2

4.3

深度学习的基础：稠密向量表示
• 维数比较低，一般不超过500维
• 基本上都为非零值，实数

词向量获取方式
• 随机初始化，本身作为模型参数参与参
数学习

• word2vec

情感分析

深度学习

我 自己 连 看 了 三 遍 夏洛特烦恼

e1

e2

e3

e4 e5 e6 e7

e8

Pooling:

𝐦𝐚𝐱

𝒙

…
…

…
…

…
…

…
…

…
…

…
…

…
…

…
…

……
……

…
…

深度学习

我 自己 连 看 了 三 遍 夏洛特烦恼

e1

e2

e3

e4 e5 e6 e7

e8

Pooling:         𝒙 = 𝑨𝒊𝒆𝒊

预 测：

𝒚 = 𝑾𝒙

深度学习

我 自己 连 看 了 三 遍 夏洛特烦恼

e1

e2

e3

e4 e5 e6 e7

e8

Pooling:         𝒙 = 𝑨𝒊𝒆𝒊

预 测：

𝒚 = 𝑾𝒙

深度学习

我 自己 连 看 了 三 遍 夏洛特烦恼

e1

e2

e3

e4 e5 e6 e7

e8

Pooling:         𝒙 = 𝑨𝒊𝒆𝒊

预 测：

𝒚 = 𝑾𝒙

深度学习

我 自己 连 看 了 三 遍 夏洛特烦恼

e1

e2

e3

e4 e5 e6 e7

e8

Pooling:         𝒙 = 𝑨𝒊𝒆𝒊

预 测：

𝒚 = 𝑾𝒙

深度学习

我 自己 连 看 了 三 遍 夏洛特烦恼

e1

e2

e3

e4 e5 e6 e7

e8

Pooling:         𝒙 = 𝑨𝒊𝒆𝒊

预 测：

𝒚 = 𝑾𝒙

sum：𝑨𝒊 = 1

深度学习

我 自己 连 看 了 三 遍 夏洛特烦恼

e1

e2

e3

e4 e5 e6 e7

e8

Pooling:         𝒙 = 𝑨𝒊𝒆𝒊

预 测：

𝒚 = 𝑾𝒙

𝑔𝑎𝑡𝑒𝑑 : 𝐴𝑖∞ exp(tanh(𝑊𝑔 𝑒𝑖 + 𝑏𝑔 ))

深度学习

……

……

Pooling

……
……

…
…

…
…

…
…

…
…

深度学习

……

……

Pooling

…

…

……

…

…

…

…

卷积
……

…

…

深度学习

我 自己 连 看 了 三 遍 夏洛特烦恼

e1

e2

e3

e4 e5 e6 e7

e8

卷 积：

𝒉𝒊 = 𝒕𝒂𝒏𝒉( 𝒋=𝟎

𝒄 𝑼𝒋 𝒆𝒊−𝒋 )

Pooling:         𝒙 = 𝑨𝒊𝒉𝒊

预 测：

𝒚 = 𝑾𝒙

深度学习

参数更新（训练）： 反向传播
损 失： ∆𝒚 = 𝒅𝒊𝒔𝒕(𝒚, 𝒚𝒈)

深度学习

参数更新（训练）： 反向传播
损 失： ∆𝒚 = 𝒅𝒊𝒔𝒕(𝒚, 𝒚𝒈)

预 测:      ∆𝑾 = ∆𝒚 𝒙′ ; ∆𝒙 = 𝑾′∆𝒚
𝑾 = 𝑾 − 𝜼∆𝑊

∆𝒙 = ∆𝒚

𝝏𝒚
𝝏𝒙

深度学习

参数更新（训练）： 反向传播
损 失： ∆𝒚 = 𝒅𝒊𝒔𝒕(𝒚, 𝒚𝒈)

预 测:      ∆𝑾 = ∆𝒚 𝒙′ ; ∆𝒙 = 𝑾′∆𝒚
𝑾 = 𝑾 − 𝜼∆𝑊
Pooling:       ∆𝒉𝒊= 𝑨𝒊 ∆𝒙′

∆𝒙 = ∆𝒚

𝝏𝒚
𝝏𝒙

深度学习

参数更新（训练）： 反向传播
损 失： ∆𝒚 = 𝒅𝒊𝒔𝒕(𝒚, 𝒚𝒈)

预 测:      ∆𝑾 = ∆𝒚 𝒙′ ; ∆𝒙 = 𝑾′∆𝒚
𝑾 = 𝑾 − 𝜼∆𝑊
Pooling:       ∆𝒉𝒊= 𝑨𝒊 ∆𝒙′

卷积： ∆𝑼𝒋= ∆𝑼𝒋 + ∆𝒉𝒊

𝝏𝒉𝒊
𝝏𝑼𝒊

; ∆𝒆𝒊 = ∆𝒆𝒊 + ∆𝒉𝒋

𝝏𝒉𝒊
𝝏𝒆𝒊

𝑼 = 𝑼 − 𝜼∆𝑼 𝒆 = 𝒆 − 𝜼∆𝒆

∆𝒙 = ∆𝒚

𝝏𝒚
𝝏𝒙

深度学习

随机初始化所有模型参数 (-0.01, +0.01) 

for   ….  

输入一个(x, y), y转化成为 𝒑𝒚𝒈

𝒉 = 𝑵𝒆𝒖𝒓𝒂𝒍𝑵𝒆𝒕𝒘𝒐𝒓𝒌(𝒙)
𝒚 = 𝑾𝒉
𝒑𝒚 = 𝒔𝒐𝒇𝒕𝒎𝒂𝒙(𝒚) 概率形式
∆𝒚 = 𝒅𝒊𝒔𝒕 𝒚, 𝒚𝒈 = 𝒑𝒚 − 𝒑𝒚𝒈

反向传播

End     𝒑𝒚𝒈 : +  (1, 0, 0);   - (0, 0, 1); 中性 (0, 1, 0)

深度学习

大数据预训练：

word2vec

我 自己 连 看 了 三 遍 夏洛特烦恼

e1

e2

e3 e4 e5 e6

e7

e8

深度学习

大数据预训练：

word2vec

我 自己 连 ?? 了 三 遍 夏洛特烦恼

e1

e2

e3

e5 e6

e7

e8

主要内容

自然语言处理任务简介
文本分类
序列标注
结构学习
序列到序列

序列标注

 分词
 词性标注
 命名实体识别
 情感要素识别
 组块句法分析

……

分词

输入： 本次课将介绍自然语言处理相关的基本任务

输出：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

分词

 分词歧义

输入： 羽毛球拍卖完了
结果： 羽毛球拍 卖 完 了

输入： 他站起身来
结果： 他 站 起 身 来

（他 明天 起身 去 北京）

分词

输入： 羽毛球拍卖完了
结果： 羽毛球拍 卖 完 了

分类： f(上下文 )    标签
如何将分词转化成为打标签任务？

羽 毛 球 拍 卖 完 了

两类标签

B    I       I

I     B    B B 羽毛球拍 卖 完 了

分词

输入： 羽毛球拍卖完了
结果： 羽毛球拍 卖 完 了

分类： f(上下文 )    标签
如何将分词转化成为打标签任务？

羽 毛 球 拍 卖 完 了

两类标签

B    I       I

I     B    B B 羽毛球拍 卖 完 了

分词

羽 毛 球 拍 卖 完 了

特征提取： 窗口形式
手工模版提取

分词

羽 毛 球 拍 卖 完 了

特征提取： 窗口形式
手工模版提取
卷积神经网络:
𝒉𝒊 = 𝒕𝒂𝒏𝒉(𝑾 𝒆𝒊−𝟐 … 𝒆𝒊+𝟐 + 𝒃)

分词

羽 毛 球 拍 卖 完 了

特征提取： 窗口形式
手工模版提取
卷积神经网络
循环神经网络：𝒉𝒊 = 𝒕𝒂𝒏𝒉 𝑾𝒉𝒊−𝟏 + 𝒃
𝒉𝒊 = 𝒕𝒂𝒏𝒉 𝑾𝒉𝒊+𝟏 + 𝒃

词性标注

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

预测： r n

d

v

n

n

v

v

u

a

n

思考： 与分词的区别在哪里？

主要内容

自然语言处理任务简介
文本分类
序列标注
结构学习
序列到序列

结构学习

 句法分析
 语义分析
 信息抽取
 事件检测
 意见挖掘

……

结构学习

 句法分析(依存句法分析)

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将依存句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？
基于转移的系统：

Stack           |         Queue           类别： action

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？
每一步都是分类:
从所有可能的动作中选取一个目标动作

 arc-left(*)

 arc-right(*)

 shift

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？
每一步都是分类:

 arc-left(*)

 arc-right(*)

 shift

f(上下文特征 )    标签
如何提取特征？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？
如何提取特征？

依存句法分析

输入：本次 课 将 介绍 自然 语言 处理 相关 的 基本 任务

如何将句法分析转换成为分类？
如何提取特征？

人工模板、神经网络（循环神经网络）

主要内容

自然语言处理任务简介
文本分类
序列标注
结构学习
序列到序列

序列到序列

机器翻译
对话聊天
客服系统
文本摘要
问答
……

机器翻译

输入: 马拉多纳 则 斥责 老 对手 英格兰 在 裁判 判罚 中 获利

输出： Maradona rebuked his old rival , England , for 
making profits in the referee 's decision .

机器翻译

输入: 马拉多纳 则 斥责 老 对手 英格兰 在 裁判 判罚 中 获利

输出: Maradona rebuked his old rival , England , for 
making profits in the referee 's decision .

如何分类？

机器翻译

输入: 马拉多纳 则 斥责 老 对手 英格兰 在 裁判 判罚 中 获利

输出： Maradona

如何分类？

机器翻译

输入: 马拉多纳 则 斥责 老 对手 英格兰 在 裁判 判罚 中 获利

输出: Maradona rebuked

如何分类？

机器翻译

输入: 马拉多纳 则 斥责 老 对手 英格兰 在 裁判 判罚 中 获利

输出: Maradona rebuked his

如何分类？

机器翻译

输入: 马拉多纳 则 斥责 老 对手 英格兰 在 裁判 判罚 中 获利

输出: Maradona rebuked his old

如何分类？

机器翻译

输入: 马拉多纳 则 斥责 老 对手 英格兰 在 裁判 判罚 中 获利

……

如何分类？

机器翻译

输入: 马拉多纳 则 斥责 老 对手 英格兰 在 裁判 判罚 中 获利

输出: Maradona rebuked his old rival , England , for 
making profits in the referee 's decision .

如何分类？

机器翻译

输入: 马拉多纳 则 斥责 老 对手 英格兰 在 裁判 判罚 中 获利

输出: Maradona rebuked his old rival , England , for 
making profits in the referee 's decision .  <eos>

如何分类？

机器翻译

输入: 马拉多纳 则 斥责 老 对手 英格兰 在 裁判 判罚 中 获利

输出: Maradona rebuked his old

特征提取？

机器翻译

输入: 马拉多纳 则 斥责 老 对手 英格兰 在 裁判 判罚 中 获利

𝒉𝟏

𝒉𝟐 𝒉𝟑 𝒉𝟒 𝒉𝟓

𝒉𝟔 𝒉𝟕 𝒉𝟖 𝒉𝟗 𝒉𝟏𝟎 𝒉𝟏𝟏

输出: Maradona rebuked his old

特征提取？ 编码(Encoder)：循环神经网络

机器翻译

输入: 马拉多纳 则 斥责 老 对手 英格兰 在 裁判 判罚 中 获利

𝒉𝟏
𝒂𝟏

𝒉𝟐 𝒉𝟑 𝒉𝟒 𝒉𝟓

𝒉𝟔 𝒉𝟕 𝒉𝟖 𝒉𝟗 𝒉𝟏𝟎 𝒉𝟏𝟏

𝒂𝟐 𝒂𝟑 𝒂𝟒=1 𝒂𝟓 𝒂𝟔 𝒂𝟕 𝒂𝟖 𝒂𝟗 𝒂𝟏𝟎 𝒂𝟏𝟏

输出: Maradona rebuked his old

特征提取？ 编码(Encoder)：循环神经网络

解码(Decoder):   注意力机制+ 分类

𝒔𝒊 = 𝑽𝒊 𝒕𝒂𝒏𝒉(𝑾𝒉𝒊 + 𝑼𝒄𝒊 + 𝒃)
𝒂𝒊 ∞ 𝒆𝒙𝒑(𝒔𝒊 )

机器翻译

输入: 马拉多纳 则 斥责 老 对手 英格兰 在 裁判 判罚 中 获利

𝒉𝟏
𝒂𝟏

𝒉𝟐 𝒉𝟑 𝒉𝟒 𝒉𝟓

𝒉𝟔 𝒉𝟕 𝒉𝟖 𝒉𝟗 𝒉𝟏𝟎 𝒉𝟏𝟏

𝒂𝟐 𝒂𝟑 𝒂𝟒=1 𝒂𝟓 𝒂𝟔 𝒂𝟕 𝒂𝟖 𝒂𝟗 𝒂𝟏𝟎 𝒂𝟏𝟏

输出: Maradona rebuked his old

单向循环神经网络

特征提取？ 编码(Encoder)：循环神经网络

解码(Decoder):   注意力机制+ 分类

𝒔𝒊 = 𝑽𝒊 𝒕𝒂𝒏𝒉(𝑾𝒉𝒊 + 𝑼𝒄𝒊 + 𝒃)
𝒂𝒊 ∞ 𝒆𝒙𝒑(𝒔𝒊 )

The End！
Q/A??

